title: Game&Watch Zelda jack
summary: Desbloqueo del firmware de la Game&Watch Zelda.
date: 2022-12-14 22:00:00

![Zelda G&W](/images/posts/2022-12-14_zelda_gw/zelda_gw.jpg)

## Documentaci칩n paletochan

bueno, el repositorio es un poco lioso, hay que saltar de un sitio a otro pero, ahora te pongo aqui lo que he conseguido usar con exito
Este el que lo hizo y su video: https://www.youtube.com/watch?v=Rsi8p5gbaps

el video es mas para documentarte que para usarlo
Este tipo tiene 2 videos de un tutorial: https://www.youtube.com/watch?v=mIJeOWxkfPs

es el que he seguido, mayormente para abrir la consola y hacer el backup por 1a vez
grupo de reddit con casi todos los links: https://www.reddit.com/r/GameAndWatchMods/wiki/index

Interesan al principio los de github, en este orden:
https://github.com/ghidraninja/game-and-watch-backup - para el 1er backup del firmware
https://github.com/kbeckmann/game-and-watch-retro-go para instalar por 1a vez retro-go en la memoria original

una vez que te has metido con esto, querras actualizar la memoria. Tiene tela. si te muestro como ha quedado la mia, lo flipas. pero mayormente la salve de una catastrofe ya que los concectores de la memoria de la pcb se me despegaron, y al menos 2 se rompieron. tirando de cable he recuperado la consola. que penita verla 游땔
pero cerrada no se nota nada 游땏
tienes este video del tipo de antes actualizando la memoria: https://www.youtube.com/watch?v=41VCfiRKWDI

pero este video tambien es muy bueno: https://www.youtube.com/watch?v=z2huEGAS0mc

y una vez que tienes la memoria mas grande, tienes que empezar a trabajar de otra forma. Mi idea ha sido tener el firmware original y retro-go a la vez. la consola se enciende como si nada hubiera cambiado pero al presionar Start+Left entras en retro-go. Genial. Y tengo caratulas. Para ello, he seguido los pasos de este repo: https://github.com/olderzeus/game-and-watch-retro-go/tree/NewUI

eso si, no consigo que me funcione solo siguiendo los pasos. Tengo conflictos con el firmware original cuando tengo instalado el de las caratulas 1o. Lo he solucionado instalando retro-go sin caratulas (el link que mencione antes) y firmware original juntos. una vez eso funciona, sobreescribo el firmware de retro-go con el de las caratulas y ya lo tengo todo funcionando
y hasta aqui he llegado 游뗵
ahora estoy intentando meter las roms de Game&Watch. Tenia las de extension .mgw pero no son compatibles. hay que meter las que hay dentro del romset the MAME (gnw_*.zip). Las he encontrado pero tengo unos problemas de errores con el script asi que, aun estoy en ello (este es el repo para comprimir las roms https://github.com/bzhxx/LCD-Game-Emulator)
aparte de esto, aun no he investigado que mas hay. Seguro que Nino podria ayudar mas pasado este punto, es esta mucho mas avanzado que yo
y por ultimo, el servidor de discord: https://discord.gg/rE2nHVAKvn
ea 游뗵

Y por fin he resuelto el problema de las roms de G&W. Parece que no podia crear yo mi propio artwork, necesitas un fichero que se llama default.lay para cada juego. He encontrado el artwork aqui: https://drive.google.com/drive/u/0/folders/1vl9O-0jIGCHHY_lrWpOwBtqTXEKsVGOY

## Enlaces:

* [Chips compatible G&W flash upgrade](https://www.reddit.com/r/GameAndWatchMods/wiki/flash-upgrade/)
* [Esquem치tico G&W Mario](https://github.com/Upcycle-Electronics/game-and-watch-hardware)
* [Links](https://www.reddit.com/r/GameAndWatchMods/comments/mr8hxs/click_here_for_links/)
* ROMs G&W:
    * [LCD-Game-Shrinker](https://gist.github.com/DNA64/16fed499d6bd4664b78b4c0a9638e4ef)
    * [Artwork G&W hydef](https://drive.google.com/drive/folders/1IbSRYTfKoKDgZfJZTZdnKFSpBvCvgJZV)
    * [Artwork G&W hydef previews](https://drive.google.com/drive/folders/1aVBEWQsgY9UaJ0D-VrTzY80pUnYJ0jfY)
    * [Artwork G&W DarthMarino](https://drive.google.com/drive/u/0/folders/1vl9O-0jIGCHHY_lrWpOwBtqTXEKsVGOY)
* [Lista compatibilidad juegos MD](https://cryptpad.fr/sheet/#/2/sheet/edit/blA68Hq6JiCLdHR0St26pgho/)

V칤deo en espa침ol

* https://www.youtube.com/watch?v=FzyKdBgUUGc

V칤deos de RTC:

* https://www.youtube.com/watch?v=BFVnix-D600
* https://www.youtube.com/watch?v=Qrjg7XoVsko

Tutoriales:

* https://facelesstech.wordpress.com/2022/01/08/game-and-watch-hacking-with-rpi/
* https://community.element14.com/challenges-projects/project14/hacktheholidays/b/blog/posts/the-n-o-before-christmas-upgrade-time
* Repositorios:
    * [backup y restore OFW](https://github.com/ghidraninja/game-and-watch-backup)
    * [retrogo](https://github.com/sylverb/game-and-watch-retro-go)
    * [parcheado OFW para dual boot](https://github.com/BrianPugh/game-and-watch-patch)

## Compilaci칩n en Raspi

```
sudo apt update
sudo apt upgrade
sudo apt install libnewlib-arm-none-eabi build-essential git python3-pip libncurses-dev binutils-arm-none-eabi python3 libhidapi-hidraw0 libftdi1 libftdi1-2 cmake

mkdir ~/gnw
cd ~/gnw
wget https://armkeil.blob.core.windows.net/developer/Files/downloads/gnu-rm/10.3-2021.10/gcc-arm-none-eabi-10.3-2021.10-aarch64-linux.tar.bz2
sudo tar xjf gcc-arm-none-eabi-10.3-2021.10-aarch64-linux.tar.bz2 -C /usr/share

git clone https://github.com/kbeckmann/ubuntu-openocd-git-builder.git
cd ubuntu-openocd-git-builder
./build.sh
# en 32bit: openocd-git_0.12.0-rc3-1-gdfe57baa1_armhf.deb
sudo dpkg -i openocd-git_0.12.0-rc3-1-gdfe57baa1_arm64.deb

cd ~/gnw
git clone https://github.com/ghidraninja/game-and-watch-backup.git
cd game-and-watch-backup

export ADAPTER=rpi
export OPENOCD="/opt/openocd-git/bin/openocd"
export GCC_PATH=/usr/share/gcc-arm-none-eabi-10.3-2021.10/bin

./1_sanity_check.sh rpi zelda
./2_backup_flash.sh rpi zelda
./3_backup_internal_flash.sh rpi zelda
./4_unlock_device.sh rpi zelda
./5_restore.sh rpi zelda

cd ~/gnw
git clone --recurse-submodules https://github.com/sylverb/game-and-watch-retro-go
cd game-and-watch-retro-go
pip install -r requirements.txt
make clean GNW_TARGET=zelda
make romdef GNW_TARGET=zelda
make COVERFLOW=1 JPG_QUALITY=90 COMPRESS=lzma GNW_TARGET=zelda EXTFLASH_SIZE_MB=64
make flash COVERFLOW=1 JPG_QUALITY=90 COMPRESS=lzma GNW_TARGET=zelda EXTFLASH_SIZE_MB=64


External flash usage
    Capacity:     57884672 Bytes ( 55.203 MB)
    Usage:        49807529 Bytes ( 47.500 MB)
    Free:          8077143 Bytes (  7.703 MB)
```

## Compilaci칩n en Ubuntu

```
sudo apt update
sudo apt upgrade
sudo apt install libnewlib-arm-none-eabi build-essential git python3-pip libncurses-dev binutils-arm-none-eabi python3 libhidapi-hidraw0 libftdi1 libftdi1-2

mkdir ~/gnw
cd ~/gnw
wget https://armkeil.blob.core.windows.net/developer/Files/downloads/gnu-rm/10.3-2021.10/gcc-arm-none-eabi-10.3-2021.10-x86_64-linux.tar.bz2
sudo tar xjf gcc-arm-none-eabi-10.3-2021.10-x86_64-linux.tar.bz2 -C /usr/share

git clone https://github.com/kbeckmann/ubuntu-openocd-git-builder.git
cd ubuntu-openocd-git-builder
./build.sh
sudo dpkg -i openocd-git_0.12.0-rc2-28-g9501b263e_amd64.deb

cd ~/gnw
git clone https://github.com/ghidraninja/game-and-watch-backup.git
cd game-and-watch-backup

export ADAPTER=stlink
export OPENOCD="/opt/openocd-git/bin/openocd"
export GCC_PATH=/usr/share/gcc-arm-none-eabi-10.3-2021.10/bin

./1_sanity_check.sh rpi zelda
./2_backup_flash.sh rpi zelda
./3_backup_internal_flash.sh rpi zelda
./4_unlock_device.sh rpi zelda
./5_restore.sh rpi zelda

cd ~/gnw
git clone --recurse-submodules https://github.com/sylverb/game-and-watch-retro-go
cd game-and-watch-retro-go
pip install -r requirements.txt
make clean GNW_TARGET=zelda
make romdef GNW_TARGET=zelda
make COVERFLOW=1 JPG_QUALITY=90 COMPRESS=lzma GNW_TARGET=zelda EXTFLASH_SIZE_MB=64
make flash COVERFLOW=1 JPG_QUALITY=90 COMPRESS=lzma GNW_TARGET=zelda EXTFLASH_SIZE_MB=64
```

## Con OFW en Raspi

```
# Ampliaci칩n swap
sudo dphys-swapfile swapoff
sudo vi /etc/dphys-swapfile
# Cambiar: CONF_SWAPSIZE=1024
sudo dphys-swapfile setup
sudo dphys-swapfile swapon
reboot

# Instalaci칩n keystone-engine
wget https://files.pythonhosted.org/packages/0a/65/3a2e7e55cc1db188869bbbacee60036828330e0ce57fc5f05a3167ab4b4d/keystone-engine-0.9.2.tar.gz
tar -zxvf keystone-engine-0.9.2.tar.gz
cd keystone-engine-0.9.2
# 췉췉췉췉 Edit line 114 in setup.py:
# obj_dir = os.path.join(BUILD_DIR, 'llvm', 'lib', 'arm-linux-gnueabihf')
pip install --upgrade pip
pip install .

cd ~/gnw
git clone https://github.com/BrianPugh/game-and-watch-patch.git
cd game-and-watch-patch
pip install -r requirements.txt
make download_sdk
<copia de flash_backup_zelda.bin y internal_flash_backup_zelda.bin a este directorio>
make clean
make PATCH_PARAMS="--device=zelda" LARGE_FLASH=1 flash_patched
```

## Lista juegos G&W

```
gnw_ball.zip        Game & Watch Ball.gw                                        OK
gnw_bfightn.zip     Game & Watch Balloon Fight (New Wide Screen).gw             OK
gnw_bfight.zip      Game & Watch Balloon Fight (Crystal Screen).gw              OK
gnw_bjack.zip       Game & Watch Black Jack.gw                                  OK
gnw_boxing.zip      Micro Vs. System Boxing.gw                                  OK
gnw_bsweep.zip      Game & Watch Bomb Sweeper.gw                                OK
gnw_chef.zip        Game & Watch Chef.gw                                        OK
gnw_climbern.zip    Game & Watch Climber (New Wide Screen).gw                   OK
gnw_climber.zip     Game & Watch Climber (Crystal Screen).gw                    OK
gnw_dkcirc.zip      Game & Watch Donkey Kong Circus.gw                          OK
gnw_dkhockey.zip    Micro Vs. System Donkey Kong Hockey.gw                      OK
gnw_dkjrp.zip       Game & Watch Donkey Kong Jr. (Panorama Screen).gw           OK
gnw_dkjr.zip        Game & Watch Donkey Kong Jr. (New Wide Screen).gw           OK
gnw_dkong2.zip      Game & Watch Donkey Kong II.gw                              OK
gnw_dkong3.zip      Micro Vs. System Donkey Kong 3.gw                           OK
gnw_dkong.zip       Game & Watch Donkey Kong.gw                                 OK
gnw_egg.zip         Game & Watch Egg.gw                                         OK (fallan controles al principio)
gnw_fireatk.zip     Game & Watch Fire Attack.gw                                 OK (fallan controles al principio)
gnw_fires.zip       Game & Watch Fire (Silver).gw                               OK
gnw_fire.zip        Game & Watch Fire (Wide Screen).gw                          OK
gnw_flagman.zip     Game & Watch Flagman.gw                                     OK
gnw_gcliff.zip      Game & Watch Gold Cliff.gw                                  OK
gnw_ghouse.zip      Game & Watch Green House.gw                                 OK
gnw_helmet.zip      Game & Watch Helmet (CN-17 version).gw                      OK
gnw_judge.zip       Game & Watch Judge (green version).gw                       ??
gnw_lboat.zip       Game & Watch Life Boat.gw                                   OK
gnw_lion.zip        Game & Watch Lion.gw                                        OK
gnw_manholeg.zip    Game & Watch Manhole (Gold).gw                              OK
gnw_manhole.zip     Game & Watch Manhole (New Wide Screen).gw                   OK (fallan controles al principio)
gnw_mariocm.zip     Game & Watch Mario's Cement Factory (New Wide Screen).gw    OK
gnw_mariotj.zip     Game & Watch Mario The Juggler.gw                           OK
gnw_mario.zip       Game & Watch Mario Bros..gw                                 OK
gnw_mbaway.zip      Game & Watch Mario'\''s Bombs Away.gw                       OK
gnw_mickdon.zip     Game & Watch Mickey & Donald.gw                             OK
gnw_mmousep.zip     Game & Watch Mickey Mouse (Panorama Screen).gw              OK
gnw_mmouse.zip      Game & Watch Mickey Mouse (Wide Screen).gw                  OK (fallan controles al principio)
gnw_octopus.zip     Game & Watch Octopus.gw                                     OK
gnw_opanic.zip      Game & Watch Oil Panic.gw                                   OK
gnw_pchute.zip      Game & Watch Parachute.gw                                   OK
gnw_popeye.zip      Game & Watch Popeye (Wide Screen).gw                        OK
gnw_rshower.zip     Game & Watch Rain Shower.gw                                 OK
gnw_sbuster.zip     Game & Watch Safe Buster.gw                                 OK
gnw_smbn.zip        Game & Watch Super Mario Bros. (Crystal Screen).gw          OK
gnw_smb.zip         Game & Watch Super Mario Bros. (New Wide Screen).gw         OK
gnw_squish.zip      Game & Watch Squish.gw                                      OK
gnw_ssparky.zip     Game & Watch Spitball Sparky.gw                             OK
gnw_stennis.zip     Game & Watch Snoopy Tennis.gw                               OK
gnw_tbridge.zip     Game & Watch Turtle Bridge.gw                               OK
gnw_tfish.zip       Game & Watch Tropical Fish.gw                               OK
gnw_vermin.zip      Game & Watch Vermin.gw                                      OK
gnw_zelda.zip       Game & Watch Zelda.gw                                       OK
```

## ROMs que no funcionan

* MD: Virtua Racing
* SMS: Fantasy zone ii
* SMS: Golden axe
* SMS: Outrun
* SMS: Space harrier
* GB: Battletoads
* GBC: Tetris DX
* Coleco: Frogger I
* A7800: Super skate boarding
* NES: Micromachines
* MD: Landstalker - The Treasures of King Nole (da error al comprimir)

## Controles

Holding the `PAUSE/SET` button while pressing other buttons have the following actions:

| Button combination           | Action                                                                 |
| ---------------------------- | ---------------------------------------------------------------------- |
| `PAUSE/SET` + `GAME`         | Store a screenshot. (Disabled by default on 1MB flash builds)          |
| `PAUSE/SET` + `TIME`         | Toggle speedup between 1x and the last non-1x speed. Defaults to 1.5x. |
| `PAUSE/SET` + `UP`           | Brightness up.                                                         |
| `PAUSE/SET` + `DOWN`         | Brightness down.                                                       |
| `PAUSE/SET` + `RIGHT`        | Volume up.                                                             |
| `PAUSE/SET` + `LEFT`         | Volume down.                                                           |
| `PAUSE/SET` + `B`            | Load state.                                                            |
| `PAUSE/SET` + `A`            | Save state.                                                            |
| `PAUSE/SET` + `POWER`        | Poweroff WITHOUT save-stating.                                         |
| `PAUSE/SET` + `Up` + `POWER` | Mantener durante 4 segundos para Factory Reset.                        |
